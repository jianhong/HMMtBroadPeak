<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Call broad peak by Hidden Markov Models with t emissions — HMMtBroadPeak • HMMtBroadPeak</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Call broad peak by Hidden Markov Models with t emissions — HMMtBroadPeak"><meta property="og:description" content="Call very broad peaks for data such as LAD domains, NAD domains.
Reads will be count by each bins. Only bins with at least given reads
(defined by background parameter) for all samples (pool all reads for
each bin) will be subsequently normalized. These bins will be first
normalized to CPM (count per million) reads and then do log2 transform
for the ratio over control with a pseudocount.
The peaks were defined by running a hidden markov model over the
normalized values (using the R-package HMMt)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HMMtBroadPeak</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/HMMtBroadPeak.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jianhong/HMMtBroadPeak/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Call broad peak by Hidden Markov Models with t emissions</h1>
    <small class="dont-index">Source: <a href="https://github.com/jianhong/HMMtBroadPeak/blob/staging/R/HMMtBroadPeak.R" class="external-link"><code>R/HMMtBroadPeak.R</code></a></small>
    <div class="hidden name"><code>HMMtBroadPeak.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Call very broad peaks for data such as LAD domains, NAD domains.
Reads will be count by each bins. Only bins with at least given reads
(defined by background parameter) for all samples (pool all reads for
each bin) will be subsequently normalized. These bins will be first
normalized to CPM (count per million) reads and then do log2 transform
for the ratio over control with a pseudocount.
The peaks were defined by running a hidden markov model over the
normalized values (using the R-package HMMt).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HMMtBroadPeak</span><span class="op">(</span></span>
<span>  <span class="va">treatment</span>,</span>
<span>  <span class="va">control</span>,</span>
<span>  binSize <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  background <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gapwidth <span class="op">=</span> <span class="va">binSize</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-treatment-control">treatment, control<a class="anchor" aria-label="anchor" href="#arg-treatment-control"></a></dt>
<dd><p>Bam file of treatments and controls. Make sure the
index file keep same prefix name with bam file.</p></dd>


<dt id="arg-binsize">binSize<a class="anchor" aria-label="anchor" href="#arg-binsize"></a></dt>
<dd><p>The size of bins for count</p></dd>


<dt id="arg-background">background<a class="anchor" aria-label="anchor" href="#arg-background"></a></dt>
<dd><p>Only bins with at least background reads (pool all reads)
will be subsequently normalized.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>default 1.</p></dd>


<dt id="arg-gapwidth">gapwidth<a class="anchor" aria-label="anchor" href="#arg-gapwidth"></a></dt>
<dd><p>The Ranges of peaks separated by a gap less than gapwith
positions will be merged.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>parameters passed to <a href="https://rdrr.io/pkg/HMMt/man/BaumWelchT.html" class="external-link">BaumWelchT</a>
except m (fixed to 2).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with elements counts and peaks. Bothe counts and peaks
are GRanges objects.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"LB1.KD.chr1_1_5000000.bam"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"HMMtBroadPeak"</span>,</span></span>
<span class="r-in"><span>                          mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## call peak without control</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">HMMtBroadPeak</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration: 1iteration: 2iteration: 3iteration: 4iteration: 5iteration: 6iteration: 7iteration: 8iteration: 9iteration: 10iteration: 11iteration: 12iteration: 13iteration: 14iteration: 15iteration: 16iteration: 17iteration: 18iteration: 19iteration: 20iteration: 21iteration: 22iteration: 23iteration: 24iteration: 25iteration: 26iteration: 27iteration: 28iteration: 29iteration: 30iteration: 31iteration: 32iteration: 33iteration: 34iteration: 35iteration: 36iteration: 37iteration: 38iteration: 39iteration: 40iteration: 41iteration: 42iteration: 43iteration: 44iteration: 45iteration: 46iteration: 47iteration: 48iteration: 49iteration: 50iteration: 51iteration: 52iteration: 53iteration: 54iteration: 55iteration: 56iteration: 57iteration: 58iteration: 59iteration: 60iteration: 61iteration: 62iteration: 63iteration: 64iteration: 65iteration: 66iteration: 67iteration: 68iteration: 69iteration: 70iteration: 71iteration: 72iteration: 73iteration: 74iteration: 75iteration: 76iteration: 77iteration: 78iteration: 79iteration: 80iteration: 81iteration: 82iteration: 83iteration: 84iteration: 85iteration: 86iteration: 87iteration: 88iteration: 89iteration: 90iteration: 91iteration: 92iteration: 93iteration: 94iteration: 95iteration: 96iteration: 97iteration: 98iteration: 99iteration: 100iteration: 101iteration: 102iteration: 103iteration: 104iteration: 105iteration: 106iteration: 107iteration: 108iteration: 109iteration: 110iteration: 111iteration: 112iteration: 113iteration: 114iteration: 115iteration: 116iteration: 117iteration: 118iteration: 119iteration: 120iteration: 121iteration: 122iteration: 123iteration: 124iteration: 125iteration: 126iteration: 127iteration: 128iteration: 129iteration: 130iteration: 131iteration: 132iteration: 133iteration: 134iteration: 135iteration: 136iteration: 137iteration: 138iteration: 139iteration: 140iteration: 141iteration: 142iteration: 143iteration: 144iteration: 145iteration: 146iteration: 147iteration: 148iteration: 149iteration: 150iteration: 151iteration: 152iteration: 153iteration: 154iteration: 155iteration: 156iteration: 157iteration: 158iteration: 159iteration: 160iteration: 161iteration: 162iteration: 163iteration: 164iteration: 165iteration: 166iteration: 167iteration: 168iteration: 169iteration: 170iteration: 171iteration: 172iteration: 173iteration: 174iteration: 175iteration: 176iteration: 177iteration: 178iteration: 179iteration: 180iteration: 181iteration: 182iteration: 183iteration: 184iteration: 185iteration: 186iteration: 187iteration: 188iteration: 189iteration: 190iteration: 191iteration: 192iteration: 193iteration: 194iteration: 195iteration: 196iteration: 197iteration: 198iteration: 199iteration: 200iteration: 201iteration: 202iteration: 203iteration: 204iteration: 205iteration: 206iteration: 207iteration: 208iteration: 209iteration: 210iteration: 211iteration: 212iteration: 213iteration: 214iteration: 215iteration: 216iteration: 217iteration: 218iteration: 219iteration: 220iteration: 221iteration: 222iteration: 223iteration: 224iteration: 225iteration: 226iteration: 227iteration: 228iteration: 229iteration: 230iteration: 231iteration: 232iteration: 233iteration: 234iteration: 235iteration: 236iteration: 237iteration: 238iteration: 239iteration: 240iteration: 241iteration: 242iteration: 243iteration: 244iteration: 245iteration: 246iteration: 247iteration: 248iteration: 249iteration: 250iteration: 251iteration: 252iteration: 253iteration: 254iteration: 255iteration: 256iteration: 257iteration: 258iteration: 259iteration: 260iteration: 261iteration: 262iteration: 263iteration: 264iteration: 265iteration: 266iteration: 267iteration: 268iteration: 269iteration: 270iteration: 271iteration: 272iteration: 273iteration: 274iteration: 275iteration: 276iteration: 277iteration: 278iteration: 279iteration: 280iteration: 281iteration: 282iteration: 283iteration: 284iteration: 285iteration: 286iteration: 287iteration: 288iteration: 289iteration: 290iteration: 291iteration: 292iteration: 293iteration: 294iteration: 295iteration: 296iteration: 297iteration: 298iteration: 299iteration: 300iteration: 301iteration: 302iteration: 303iteration: 304iteration: 305iteration: 306iteration: 307iteration: 308iteration: 309iteration: 310iteration: 311iteration: 312iteration: 313iteration: 314iteration: 315iteration: 316iteration: 317iteration: 318iteration: 319iteration: 320iteration: 321iteration: 322iteration: 323iteration: 324iteration: 325iteration: 326iteration: 327iteration: 328iteration: 329iteration: 330iteration: 331iteration: 332iteration: 333iteration: 334iteration: 335iteration: 336iteration: 337iteration: 338iteration: 339iteration: 340iteration: 341iteration: 342iteration: 343iteration: 344iteration: 345iteration: 346iteration: 347iteration: 348iteration: 349iteration: 350iteration: 351iteration: 352iteration: 353iteration: 354iteration: 355iteration: 356iteration: 357iteration: 358iteration: 359iteration: 360iteration: 361iteration: 362iteration: 363iteration: 364iteration: 365iteration: 366iteration: 367iteration: 368iteration: 369iteration: 370iteration: 371iteration: 372iteration: 373iteration: 374iteration: 375iteration: 376iteration: 377iteration: 378iteration: 379iteration: 380iteration: 381iteration: 382iteration: 383iteration: 384iteration: 385iteration: 386iteration: 387iteration: 388iteration: 389iteration: 390iteration: 391iteration: 392iteration: 393iteration: 394iteration: 395iteration: 396iteration: 397iteration: 398iteration: 399iteration: 400iteration: 401iteration: 402iteration: 403iteration: 404iteration: 405iteration: 406iteration: 407iteration: 408iteration: 409iteration: 410iteration: 411iteration: 412iteration: 413iteration: 414iteration: 415iteration: 416iteration: 417iteration: 418iteration: 419iteration: 420iteration: 421iteration: 422iteration: 423iteration: 424iteration: 425iteration: 426iteration: 427iteration: 428iteration: 429iteration: 430iteration: 431iteration: 432iteration: 433iteration: 434iteration: 435iteration: 436iteration: 437iteration: 438iteration: 439iteration: 440iteration: 441iteration: 442iteration: 443iteration: 444iteration: 445iteration: 446iteration: 447iteration: 448iteration: 449iteration: 450iteration: 451iteration: 452iteration: 453iteration: 454iteration: 455iteration: 456iteration: 457iteration: 458iteration: 459iteration: 460iteration: 461iteration: 462iteration: 463iteration: 464iteration: 465iteration: 466iteration: 467iteration: 468iteration: 469iteration: 470iteration: 471iteration: 472iteration: 473iteration: 474iteration: 475iteration: 476iteration: 477iteration: 478iteration: 479iteration: 480iteration: 481iteration: 482iteration: 483iteration: 484iteration: 485iteration: 486iteration: 487iteration: 488iteration: 489iteration: 490iteration: 491iteration: 492iteration: 493iteration: 494iteration: 495iteration: 496iteration: 497iteration: 498iteration: 499iteration: 500</span>
<span class="r-in"><span><span class="co">## call peak with control</span></span></span>
<span class="r-in"><span><span class="va">control</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"LB1.WT.chr1_1_5000000.bam"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"HMMtBroadPeak"</span>,</span></span>
<span class="r-in"><span>                          mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">called</span> <span class="op">&lt;-</span> <span class="fu">HMMtBroadPeak</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">control</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration: 1iteration: 2iteration: 3iteration: 4iteration: 5iteration: 6iteration: 7iteration: 8iteration: 9iteration: 10iteration: 11iteration: 12iteration: 13iteration: 14iteration: 15iteration: 16iteration: 17iteration: 18iteration: 19iteration: 20iteration: 21iteration: 22iteration: 23iteration: 24iteration: 25iteration: 26iteration: 27iteration: 28iteration: 29iteration: 30iteration: 31iteration: 32iteration: 33iteration: 34iteration: 35iteration: 36iteration: 37iteration: 38iteration: 39iteration: 40iteration: 41iteration: 42iteration: 43iteration: 44iteration: 45iteration: 46iteration: 47iteration: 48iteration: 49iteration: 50iteration: 51iteration: 52iteration: 53iteration: 54iteration: 55</span>
<span class="r-in"><span><span class="va">called</span><span class="op">$</span><span class="va">peaks</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 9 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames          ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1   499502-504496      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1   594407-609391      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1   624377-649351      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1   664337-669331      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1   709292-719281      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6]     chr1   729272-734266      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7]     chr1  754247-2662339      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8]     chr1 2672330-2692309      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9]     chr1 2747255-5000001      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome</span>
<span class="r-in"><span><span class="fu"><a href="plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">called</span>, seqname<span class="op">=</span><span class="st">"chr1"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="HMMtBroadPeak-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jianhong Ou.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

